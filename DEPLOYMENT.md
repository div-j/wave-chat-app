# Django Chat App - Docker Deployment on Render

## Local Testing with Docker

### Build and run locally:
```bash
# Build the Docker image
docker build -t chat-app .

# Run with docker-compose
docker-compose up

# Access at http://localhost:8000
```

### Stop the application:
```bash
docker-compose down
```

## Deploying to Render

### Prerequisites:
1. A Render account (sign up at https://render.com)
2. Your code pushed to a GitHub repository

### Deployment Steps:

1. **Connect Your Repository:**
   - Go to Render Dashboard (https://dashboard.render.com)
   - Click "New" â†’ "Blueprint"
   - Connect your GitHub repository
   - Render will detect the `render.yaml` file

2. **Configure Environment Variables (Optional):**
   - The `render.yaml` already includes necessary environment variables
   - `SECRET_KEY` will be auto-generated
   - You can add more variables in the Render dashboard if needed

3. **Deploy:**
   - Click "Apply" to start the deployment
   - Render will build the Docker image and deploy your app
   - The SQLite database will persist on the attached disk

### Important Notes:

- **SQLite Persistence:** The database is stored in `/app/data/db.sqlite3` with a 1GB persistent disk
- **Free Tier:** Configured for Render's free plan
- **Region:** Set to Oregon (can be changed in `render.yaml`)
- **WebSockets:** Supported via Daphne ASGI server
- **Static Files:** Served via WhiteNoise middleware

### Accessing Your App:
Once deployed, Render will provide a URL like:
`https://chat-app-xxxx.onrender.com`

### Monitoring:
- View logs in the Render dashboard
- Check deployment status and metrics
- View disk usage for the SQLite database

### Database Access:
To access your SQLite database:
1. Use Render Shell (from dashboard)
2. Run: `sqlite3 /app/data/db.sqlite3`

## Environment Variables (for reference)

The following are configured in `render.yaml`:
- `DEBUG`: Set to "False" for production
- `SECRET_KEY`: Auto-generated by Render
- `DATABASE_PATH`: `/app/data/db.sqlite3`
- `DJANGO_SETTINGS_MODULE`: `chat_app.settings`

## Troubleshooting

### If deployment fails:
1. Check logs in Render dashboard
2. Verify all dependencies in `requirements.txt`
3. Ensure migrations run successfully
4. Check disk is properly mounted

### If WebSocket connections fail:
- Ensure your Render plan supports WebSockets
- Check that Daphne is running (not gunicorn)
- Verify ASGI application is configured correctly

### Database issues:
- The SQLite database will be created on first run
- Data persists across deployments via the disk mount
- For fresh start, you can delete and recreate the disk in Render
